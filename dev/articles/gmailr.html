<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>gmailr • gmailr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="gmailr">
<meta name="robots" content="noindex">
<script src="https://cdn.jsdelivr.net/gh/posit-dev/supported-by-posit/js/badge.min.js" data-max-height="43" data-light-bg="#666f76" data-light-fg="#f9f9f9"></script><script defer data-domain="gmailr.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gmailr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/gmailr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/deploy-a-token.html">Deploy a token</a></li>
    <li><a class="dropdown-item" href="../articles/oauth-client.html">Set up an OAuth client</a></li>
    <li><a class="dropdown-item" href="../articles/sending_messages.html">Sending Messages With Gmailr</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2023/06/gmailr-1-0-0/">gmailr 2.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/08/gmailr-1-0-0/">gmailr 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/gmailr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>gmailr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/gmailr/blob/main/vignettes/gmailr.Rmd" class="external-link"><code>vignettes/gmailr.Rmd</code></a></small>
      <div class="d-none name"><code>gmailr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmailr.r-lib.org">gmailr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="oauth-client">OAuth client<a class="anchor" aria-label="anchor" href="#oauth-client"></a>
</h2>
<p>In order to use gmailr, you <strong>must</strong> provide your own
OAuth client. The article <a href="https://gmailr.r-lib.org/dev/articles/oauth-client.html">Set up an
OAuth client</a> explains how to obtain an OAuth client and how to
configure it for gmailr’s use. The help topics for
<code><a href="../reference/gm_auth_configure.html">?gm_auth_configure</a></code> and
<code><a href="../reference/gmailr-configuration.html">?gm_default_oauth_client</a></code> will also be useful.</p>
<p>Unless you have reason to do otherwise, my recommendation is to place
the JSON file for your OAuth client in the default location, so that it
is discovered automatically. The default location is returned by
<code>rappdirs::user_data_dir("gmailr")</code>. Alternatively, you can
also make autodiscovery work by exposing the client’s JSON filepath as
the <code>GMAILR_OAUTH_CLIENT</code> environment variable. If your
client is configured for auto-discovery, your gmailr code should “just
work”, without any explicit configuration around the client:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmailr.r-lib.org">gmailr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># your gmailr code ...</span></span></code></pre></div>
<p>Otherwise, your code must always include a call to
<code><a href="../reference/gm_auth_configure.html">gm_auth_configure()</a></code>, probably right after you attach
gmailr:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmailr.r-lib.org">gmailr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gm_auth_configure.html">gm_auth_configure</a></span><span class="op">(</span><span class="st">"path/to/your/oauth_client.json"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># your gmailr code ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="auth">Auth<a class="anchor" aria-label="anchor" href="#auth"></a>
</h2>
<p>Configuring an OAuth client is step 1 of 2 for getting ready to use
gmailr. Step 2 is to complete the so-called “OAuth dance”.</p>
<p>For most folks and especially in early usage, you can just allow the
OAuth dance to be triggered automatically upon first need. You are taken
to a web browser, where you must select or login as the Google user you
want to use (authenticate yourself) and give your OAuth client
permission to do Gmail stuff on your behalf (authorize). The OAuth dance
does not need to be repeated in subsequent sessions, because, by
default, your credentials are cached locally and can be refreshed.</p>
<p>If, however, you want to take more control over auth, you can call
<code><a href="../reference/gm_auth.html">gm_auth()</a></code> explicitly and proactively. The arguments that
are most useful in practice are:</p>
<ul>
<li>
<code>email</code>: Use this to specify the target user. This can be
useful if you have a cached token and you want code to run without an
attempt to get interactive confirmation that it’s OK to use it.</li>
<li>
<code>scopes</code>: Following the principle of least privilege, if
you have no intention of sending email, it could be wise to deliberately
use a token with a “read only” scope.</li>
<li>
<code>token</code>: In a deployed setting, it can be useful to
directly provide a stored token to gmailr. This use case is documented
in <code>vignettes("deploy-a-token")</code>.</li>
</ul>
<p>Here’s how a script might begin if the OAuth client can’t be
auto-discovered and the user needs to request non-default behaviour from
<code><a href="../reference/gm_auth.html">gm_auth()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmailr.r-lib.org">gmailr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gm_auth_configure.html">gm_auth_configure</a></span><span class="op">(</span><span class="st">"path/to/your/oauth_client.json"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gm_auth.html">gm_auth</a></span><span class="op">(</span></span>
<span>  <span class="st">"target.user@example.com"</span>,</span>
<span>  scopes <span class="op">=</span> <span class="st">"gmail.readonly"</span>,</span>
<span>  cache <span class="op">=</span> <span class="st">"some/nice/directory/"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/gm_profile.html">gm_profile()</a></code> is a handy function to confirm that gmailr
is using the intended Google identity.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gm_profile.html">gm_profile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Logged in as:</span></span>
<span><span class="co">#&gt;   * email: gargle-testuser@posit.co</span></span>
<span><span class="co">#&gt;   * num_messages: 19</span></span>
<span><span class="co">#&gt;   * num_threads: 19</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compose-and-send-an-email">Compose and send an email<a class="anchor" aria-label="anchor" href="#compose-and-send-an-email"></a>
</h2>
<p>Create a new email with <code><a href="../reference/gm_mime.html">gm_mime()</a></code> and then build it up
from parts, using helper functions like <code><a href="../reference/accessors.html">gm_to()</a></code> and
<code><a href="../reference/accessors.html">gm_subject()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_email</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/gm_mime.html">gm_mime</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/accessors.html">gm_to</a></span><span class="op">(</span><span class="st">"PUT_A_VALID_EMAIL_ADDRESS_THAT_YOU_CAN_CHECK_HERE"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/accessors.html">gm_subject</a></span><span class="op">(</span><span class="st">"this is just a gmailr test"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gm_mime.html">gm_text_body</a></span><span class="op">(</span><span class="st">"Can you hear me now?"</span><span class="op">)</span></span></code></pre></div>
<p>You can even add a file attachment with
<code><a href="../reference/gm_mime.html">gm_attach_file()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"mtcars-"</span>, fileext <span class="op">=</span> <span class="st">".csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">tmp</span><span class="op">)</span></span>
<span><span class="va">test_email</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gm_mime.html">gm_attach_file</a></span><span class="op">(</span><span class="va">test_email</span>, <span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
<p>When developing a message, it’s a good idea to first create a draft
with <code><a href="../reference/gm_create_draft.html">gm_create_draft()</a></code> Then you can visit your Gmail drafts
in the browser and confirm that the message content and formatting is as
you intend.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gm_create_draft.html">gm_create_draft</a></span><span class="op">(</span><span class="va">test_email</span><span class="op">)</span></span></code></pre></div>
<p>If you’re happy, you can either send that draft from the web UI or
with <code><a href="../reference/gm_send_draft.html">gm_send_draft()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gm_send_draft.html">gm_send_draft</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Draft Id: </span>19a513fd0ea12a40 </span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Or you can send the original MIME message with
<code><a href="../reference/gm_send_message.html">gm_send_message()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gm_send_message.html">gm_send_message</a></span><span class="op">(</span><span class="va">test_email</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="read-email">Read email<a class="anchor" aria-label="anchor" href="#read-email"></a>
</h2>
<p>You can retrieve email threads with <code><a href="../reference/gm_threads.html">gm_threads()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_threads</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gm_threads.html">gm_threads</a></span><span class="op">(</span>num_results <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>You can retrieve a specific thread with <code><a href="../reference/gm_thread.html">gm_thread()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># retrieve the latest thread by retrieving the first ID</span></span>
<span><span class="va">latest_thread</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gm_thread.html">gm_thread</a></span><span class="op">(</span><span class="fu"><a href="../reference/gm_id.html">gm_id</a></span><span class="op">(</span><span class="va">my_threads</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The messages in <code>latest_thread</code> are stored as a list. You
can then isolate a specific message and access its parts.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_msg</span> <span class="op">&lt;-</span> <span class="va">latest_thread</span><span class="op">$</span><span class="va">messages</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/accessors.html">gm_date</a></span><span class="op">(</span><span class="va">my_msg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Tue, 4 Nov 2025 15:42:08 -0800"</span></span>
<span><span class="fu"><a href="../reference/accessors.html">gm_subject</a></span><span class="op">(</span><span class="va">my_msg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "this is just a gmailr test"</span></span>
<span><span class="fu"><a href="../reference/gm_body.html">gm_body</a></span><span class="op">(</span><span class="va">my_msg</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "Can you hear me now?\r\n"</span></span></code></pre></div>
<p>If a message has attachments, you can download them all locally with
<code><a href="../reference/gm_save_attachments.html">gm_save_attachments()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"attachments-"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gm_save_attachments.html">gm_save_attachments</a></span><span class="op">(</span><span class="va">my_msg</span>, path <span class="op">=</span> <span class="va">tmp2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let's take a peek</span></span>
<span><span class="va">tmp2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>full.names <span class="op">=</span> <span class="cn">TRUE</span>, pattern <span class="op">=</span> <span class="st">"[.]csv$"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   X  mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span><span class="co">#&gt; 1         Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span><span class="co">#&gt; 2     Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span><span class="co">#&gt; 3        Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span><span class="co">#&gt; 4    Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</span></span>
<span><span class="co">#&gt; 5 Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</span></span>
<span><span class="co">#&gt; 6           Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quota">Quota<a class="anchor" aria-label="anchor" href="#quota"></a>
</h2>
<p>The Gmail API is free to use for modest levels of activity. To learn
more about Gmail API quotas see <a href="https://developers.google.com/gmail/api/reference/quota" class="external-link uri">https://developers.google.com/gmail/api/reference/quota</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.jimhester.com/" class="external-link">Jim Hester</a>, <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
